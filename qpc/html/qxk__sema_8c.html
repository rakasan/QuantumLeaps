<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C: qxk_sema.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a id="logo" title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img src="img/logo_ql.png" alt="Quantum Leaps" style="vertical-align:top; border:none;">
  </a>
  <span id="projectname">QP/C</span>
  <span id="projectnumber">6.9.1</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qxk__sema_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">qxk_sema.c File Reference<div class="ingroups"><a class="el" href="group__qxk.html">QXK</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>QXK preemptive kernel semaphore functions.
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;qf_port.h&quot;</code><br />
<code>#include &quot;<a class="el" href="qxk__pkg_8h_source.html">qxk_pkg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qassert_8h_source.html">qassert.h</a>&quot;</code><br />
<code>#include &quot;qs_port.h&quot;</code><br />
<code>#include &quot;<a class="el" href="qs__pkg_8h_source.html">qs_pkg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for qxk_sema.c:</div>
<div class="dyncontent">
<div class="center"><img src="qxk__sema_8c__incl.png" border="0" usemap="#aqxk__sema_8c" alt=""/></div>
</div>
</div>
<p><a href="qxk__sema_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a25c3d21c629fb4d36aedc9e127ae3c75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qxk__sema_8c.html#a25c3d21c629fb4d36aedc9e127ae3c75">QXSemaphore_init</a> (<a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const me, <a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> count, <a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> max_count)</td></tr>
<tr class="memdesc:a25c3d21c629fb4d36aedc9e127ae3c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the counting semaphore  <a href="qxk__sema_8c.html#a25c3d21c629fb4d36aedc9e127ae3c75">More...</a><br /></td></tr>
<tr class="separator:a25c3d21c629fb4d36aedc9e127ae3c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c62839759971359392742618d58e70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qxk__sema_8c.html#a93c62839759971359392742618d58e70">QXSemaphore_wait</a> (<a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const me, <a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> const nTicks)</td></tr>
<tr class="memdesc:a93c62839759971359392742618d58e70"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait (block) on the semaphore  <a href="qxk__sema_8c.html#a93c62839759971359392742618d58e70">More...</a><br /></td></tr>
<tr class="separator:a93c62839759971359392742618d58e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7caf16a6092236c4118adfc2ed52cb02"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qxk__sema_8c.html#a7caf16a6092236c4118adfc2ed52cb02">QXSemaphore_tryWait</a> (<a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const me)</td></tr>
<tr class="memdesc:a7caf16a6092236c4118adfc2ed52cb02"><td class="mdescLeft">&#160;</td><td class="mdescRight">try wait on the semaphore (non-blocking)  <a href="qxk__sema_8c.html#a7caf16a6092236c4118adfc2ed52cb02">More...</a><br /></td></tr>
<tr class="separator:a7caf16a6092236c4118adfc2ed52cb02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a42fa24556ea0d0a203d28555b70108"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qxk__sema_8c.html#a0a42fa24556ea0d0a203d28555b70108">QXSemaphore_signal</a> (<a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const me)</td></tr>
<tr class="memdesc:a0a42fa24556ea0d0a203d28555b70108"><td class="mdescLeft">&#160;</td><td class="mdescRight">signal (unblock) the semaphore  <a href="qxk__sema_8c.html#a0a42fa24556ea0d0a203d28555b70108">More...</a><br /></td></tr>
<tr class="separator:a0a42fa24556ea0d0a203d28555b70108"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>QXK preemptive kernel semaphore functions. </p>

<p class="definition">Definition in file <a class="el" href="qxk__sema_8c_source.html">qxk_sema.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a25c3d21c629fb4d36aedc9e127ae3c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25c3d21c629fb4d36aedc9e127ae3c75">&#9670;&nbsp;</a></span>QXSemaphore_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QXSemaphore_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a>&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a>&#160;</td>
          <td class="paramname"><em>max_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the counting semaphore </p>
<dl class="section user"><dt>Description</dt><dd>Initializes a semaphore with the specified count and maximum count. If the semaphore is used for resource sharing, both the initial count and maximum count should be set to the number of identical resources guarded by the semaphore. If the semaphore is used as a signaling mechanism, the initial count should set to 0 and maximum count to 1 (binary semaphore).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>initial value of the semaphore counter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_count</td><td>maximum value of the semaphore counter. The purpose of the max_count is to limit the counter so that the semaphore cannot unblock more times than the maximum.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="qxk__sema_8c.html#a25c3d21c629fb4d36aedc9e127ae3c75" title="initialize the counting semaphore">QXSemaphore_init()</a> must be called <b>before</b> the semaphore can be used (signaled or waited on). </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>max_count must be greater than zero</dd></dl>

<p class="definition">Definition at line <a class="el" href="qxk__sema_8c_source.html#l00079">79</a> of file <a class="el" href="qxk__sema_8c_source.html">qxk_sema.c</a>.</p>

</div>
</div>
<a id="a93c62839759971359392742618d58e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c62839759971359392742618d58e70">&#9670;&nbsp;</a></span>QXSemaphore_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QXSemaphore_wait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> const&#160;</td>
          <td class="paramname"><em>nTicks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wait (block) on the semaphore </p>
<dl class="section user"><dt>Description</dt><dd>When an extended thread calls <a class="el" href="qxk__sema_8c.html#a93c62839759971359392742618d58e70" title="wait (block) on the semaphore">QXSemaphore_wait()</a> and the value of the semaphore counter is greater than 0, <a class="el" href="qxk__sema_8c.html#a93c62839759971359392742618d58e70" title="wait (block) on the semaphore">QXSemaphore_wait()</a> decrements the semaphore counter and returns (true) to its caller. However, if the value of the semaphore counter is 0, the function places the calling thread in the waiting list for the semaphore. The thread waits until the semaphore is signaled by calling <a class="el" href="qxk__sema_8c.html#a0a42fa24556ea0d0a203d28555b70108" title="signal (unblock) the semaphore">QXSemaphore_signal()</a>, or the specified timeout expires. If the semaphore is signaled before the timeout expires, QXK resumes the highest-priority extended thread waiting for the semaphore.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nTicks</td><td>number of clock ticks (at the associated rate) to wait for the semaphore. The value of QXTHREAD_NO_TIMEOUT indicates that no timeout will occur and the semaphore will wait indefinitely.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if the semaphore has been signaled and 'false' if a timeout occured.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Multiple extended threads can wait for a given semahpre. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>this function must:<ul>
<li>NOT be called from an ISR;</li>
<li>the semaphore must be initialized</li>
<li>be called from an extended thread;</li>
<li>the thread must NOT be already blocked on any object.</li>
</ul>
</dd>
<dd>
also: the thread must NOT be holding a scheduler lock.</dd></dl>

<p class="definition">Definition at line <a class="el" href="qxk__sema_8c_source.html#l00114">114</a> of file <a class="el" href="qxk__sema_8c_source.html">qxk_sema.c</a>.</p>

</div>
</div>
<a id="a7caf16a6092236c4118adfc2ed52cb02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7caf16a6092236c4118adfc2ed52cb02">&#9670;&nbsp;</a></span>QXSemaphore_tryWait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QXSemaphore_tryWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>try wait on the semaphore (non-blocking) </p>
<dl class="section user"><dt>Description</dt><dd>This function checks if the semaphore counter is greater than 0, in which case the counter is decremented.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if the semaphore has count available and 'false' NOT available.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called from any context, including ISRs and basic threds (active objects). </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>the semaphore must be initialized</dd></dl>

<p class="definition">Definition at line <a class="el" href="qxk__sema_8c_source.html#l00199">199</a> of file <a class="el" href="qxk__sema_8c_source.html">qxk_sema.c</a>.</p>

</div>
</div>
<a id="a0a42fa24556ea0d0a203d28555b70108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a42fa24556ea0d0a203d28555b70108">&#9670;&nbsp;</a></span>QXSemaphore_signal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QXSemaphore_signal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qxthread_8h.html#struct_q_x_semaphore">QXSemaphore</a> *const&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>signal (unblock) the semaphore </p>
<dl class="section user"><dt>Description</dt><dd>If the semaphore counter value is 0 or more, it is incremented, and this function returns to its caller. If the extended threads are waiting for the semaphore to be signaled, <a class="el" href="qxk__sema_8c.html#a0a42fa24556ea0d0a203d28555b70108" title="signal (unblock) the semaphore">QXSemaphore_signal()</a> removes the highest- priority thread waiting for the semaphore from the waiting list and makes this thread ready-to-run. The QXK scheduler is then called to determine if the awakened thread is now the highest-priority thread that is ready-to-run.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' when the semaphore signaled and 'false' when the semaphore count exceeded the maximum.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>A semaphore can be signaled from many places, including from ISRs, basic threads (AOs), and extended threads. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>the semaphore must be initialized</dd></dl>

<p class="definition">Definition at line <a class="el" href="qxk__sema_8c_source.html#l00240">240</a> of file <a class="el" href="qxk__sema_8c_source.html">qxk_sema.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="navelem"><a class="el" href="dir_28a04cc6444cdd1b436423abf3214ac3.html">src</a></li><li class="navelem"><a class="el" href="dir_08fe79f9fb91e223ef6854c32de3c82b.html">qxk</a></li><li class="navelem"><a class="el" href="qxk__sema_8c.html">qxk_sema.c</a></li>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C 6.9.1</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C 6.9.1</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
