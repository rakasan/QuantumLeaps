<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C: qf_time.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <a id="logo" title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">
    <img src="img/logo_ql.png" alt="Quantum Leaps" style="vertical-align:top; border:none;">
  </a>
  <span id="projectname">QP/C</span>
  <span id="projectnumber">6.9.1</span>
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qf__time_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">qf_time.c File Reference<div class="ingroups"><a class="el" href="group__qf.html">QF</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="struct_q_time_evt.html" title="Time Event class.">QTimeEvt</a> implementation and QF system clock tick <a class="el" href="qf__time_8c.html#a8cf676a0ed64ab7ed8a8151f1f2e7c82" title="Processes all armed time events at every clock tick.">QF_tickX_()</a>)
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;qf_port.h&quot;</code><br />
<code>#include &quot;<a class="el" href="qf__pkg_8h_source.html">qf_pkg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qassert_8h_source.html">qassert.h</a>&quot;</code><br />
<code>#include &quot;qs_port.h&quot;</code><br />
<code>#include &quot;<a class="el" href="qs__pkg_8h_source.html">qs_pkg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for qf_time.c:</div>
<div class="dyncontent">
<div class="center"><img src="qf__time_8c__incl.png" border="0" usemap="#aqf__time_8c" alt=""/></div>
</div>
</div>
<p><a href="qf__time_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8cf676a0ed64ab7ed8a8151f1f2e7c82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a8cf676a0ed64ab7ed8a8151f1f2e7c82">QF_tickX_</a> (<a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a> const tickRate, void const *const sender)</td></tr>
<tr class="memdesc:a8cf676a0ed64ab7ed8a8151f1f2e7c82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes all armed time events at every clock tick.  <a href="qf__time_8c.html#a8cf676a0ed64ab7ed8a8151f1f2e7c82">More...</a><br /></td></tr>
<tr class="separator:a8cf676a0ed64ab7ed8a8151f1f2e7c82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691ef631f5557b516f13f32ca9eb1338"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a691ef631f5557b516f13f32ca9eb1338">QF_noTimeEvtsActiveX</a> (<a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a> const tickRate)</td></tr>
<tr class="memdesc:a691ef631f5557b516f13f32ca9eb1338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns 'true' if there are no armed time events at a given tick rate.  <a href="qf__time_8c.html#a691ef631f5557b516f13f32ca9eb1338">More...</a><br /></td></tr>
<tr class="separator:a691ef631f5557b516f13f32ca9eb1338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790b654800908426f563112107b11647"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a790b654800908426f563112107b11647">QTimeEvt_ctorX</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const me, <a class="el" href="struct_q_active.html">QActive</a> *const act, <a class="el" href="qep_8h.html#ad11e2d4dff3c15b0b5f9a13a47c7fb1a">enum_t</a> const sig, <a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a> tickRate)</td></tr>
<tr class="separator:a790b654800908426f563112107b11647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bbcb00315fb8bb8641003b2b2d07ce4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a9bbcb00315fb8bb8641003b2b2d07ce4">QTimeEvt_armX</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const me, <a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const nTicks, <a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const interval)</td></tr>
<tr class="separator:a9bbcb00315fb8bb8641003b2b2d07ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d4bc166d6d02d43fe5621cdd29c5013"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a9d4bc166d6d02d43fe5621cdd29c5013">QTimeEvt_disarm</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const me)</td></tr>
<tr class="separator:a9d4bc166d6d02d43fe5621cdd29c5013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5734e32caac22b89766a4b90a1679b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a3a5734e32caac22b89766a4b90a1679b">QTimeEvt_rearm</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const me, <a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const nTicks)</td></tr>
<tr class="separator:a3a5734e32caac22b89766a4b90a1679b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972d04658e1c8eec71da5976db433505"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a972d04658e1c8eec71da5976db433505">QTimeEvt_wasDisarmed</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const me)</td></tr>
<tr class="separator:a972d04658e1c8eec71da5976db433505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8fc8c4421ae5131408ca74bd8138de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#a5d8fc8c4421ae5131408ca74bd8138de">QTimeEvt_currCtr</a> (<a class="el" href="struct_q_time_evt.html">QTimeEvt</a> const *const me)</td></tr>
<tr class="separator:a5d8fc8c4421ae5131408ca74bd8138de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aae27f8be7b90468f9023fc4d2047dac4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qf__time_8c.html#aae27f8be7b90468f9023fc4d2047dac4">QF_timeEvtHead_</a> [<a class="el" href="qxk_2qf__port_8h.html#a2b5eb0c96105f58726359f4fcfae9530">QF_MAX_TICK_RATE</a>]</td></tr>
<tr class="memdesc:aae27f8be7b90468f9023fc4d2047dac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">heads of linked lists of time events, one for every clock tick rate  <a href="qf__time_8c.html#aae27f8be7b90468f9023fc4d2047dac4">More...</a><br /></td></tr>
<tr class="separator:aae27f8be7b90468f9023fc4d2047dac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="struct_q_time_evt.html" title="Time Event class.">QTimeEvt</a> implementation and QF system clock tick <a class="el" href="qf__time_8c.html#a8cf676a0ed64ab7ed8a8151f1f2e7c82" title="Processes all armed time events at every clock tick.">QF_tickX_()</a>) </p>

<p class="definition">Definition in file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8cf676a0ed64ab7ed8a8151f1f2e7c82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf676a0ed64ab7ed8a8151f1f2e7c82">&#9670;&nbsp;</a></span>QF_tickX_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QF_tickX_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a> const&#160;</td>
          <td class="paramname"><em>tickRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *const&#160;</td>
          <td class="paramname"><em>sender</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes all armed time events at every clock tick. </p>
<dl class="section user"><dt>Description</dt><dd>This function must be called periodically from a time-tick ISR or from a task so that QF can manage the timeout events assigned to the given system clock tick rate.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tickRate</td><td>system clock tick rate serviced in this call [1..15]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sender</td><td>pointer to a sender object (used only for QS tracing)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>this function should be called only via the macro <a class="el" href="qf_8h.html#a1f1970e16f4d010b5e5b2fd046aac41e" title="Invoke the system clock tick processing QF_tickX_().">QF_TICK_X()</a></dd>
<dd>
the calls to <a class="el" href="qf__time_8c.html#a8cf676a0ed64ab7ed8a8151f1f2e7c82" title="Processes all armed time events at every clock tick.">QF_tickX_()</a> with different <code>tickRate</code> parameter can preempt each other. For example, higher clock tick rates might be serviced from interrupts while others from tasks (active objects).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="struct_q_time_evt.html" title="Time Event class.">QTimeEvt</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00078">78</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a691ef631f5557b516f13f32ca9eb1338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691ef631f5557b516f13f32ca9eb1338">&#9670;&nbsp;</a></span>QF_noTimeEvtsActiveX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QF_noTimeEvtsActiveX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a> const&#160;</td>
          <td class="paramname"><em>tickRate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns 'true' if there are no armed time events at a given tick rate. </p>
<dl class="section user"><dt>Description</dt><dd>Find out if any time events are armed at the given clock tick rate.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tickRate</td><td>system clock tick rate to find out about.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if no time events are armed at the given tick rate and 'false' otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function should be called in critical section. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00205">205</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a790b654800908426f563112107b11647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a790b654800908426f563112107b11647">&#9670;&nbsp;</a></span>QTimeEvt_ctorX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QTimeEvt_ctorX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_q_active.html">QActive</a> *const&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qep_8h.html#ad11e2d4dff3c15b0b5f9a13a47c7fb1a">enum_t</a> const&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#ad0906fbe05a45fbdb000c58fe8929e70">uint_fast8_t</a>&#160;</td>
          <td class="paramname"><em>tickRate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>When creating a time event, you must commit it to a specific active object <code>act</code>, tick rate <code>tickRate</code> and event signal <code>sig</code>. You cannot change these attributes later.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">act</td><td>pointer to the active object associated with this time event. The time event will post itself to this AO. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>signal to associate with this time event. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tickRate</td><td>systemclock tick rate to associate with this time event in the range [0..15].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>You should call the constructor exactly once for every Time Event object <b>before</b> arming the Time Event. The ideal place for initializing the time event(s) associated with a given AO is the AO's constructor. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>The signal must be valid and the tick rate in range</dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00238">238</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a9bbcb00315fb8bb8641003b2b2d07ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bbcb00315fb8bb8641003b2b2d07ce4">&#9670;&nbsp;</a></span>QTimeEvt_armX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QTimeEvt_armX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const&#160;</td>
          <td class="paramname"><em>nTicks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const&#160;</td>
          <td class="paramname"><em>interval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>Arms a time event to fire in a specified number of clock ticks and with a specified interval. If the interval is zero, the time event is armed for one shot ('one-shot' time event). The time event gets directly posted (using the FIFO policy) into the event queue of the host active object.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nTicks</td><td>number of clock ticks (at the associated rate) to rearm the time event with. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interval</td><td>interval (in clock ticks) for periodic time event.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>After posting, a one-shot time event gets automatically disarmed while a periodic time event (interval != 0) is automatically re-armed.</dd>
<dd>
A time event can be disarmed at any time by calling the <a class="el" href="struct_q_time_evt.html#a9d4bc166d6d02d43fe5621cdd29c5013" title="Disarm a time event.">QTimeEvt_disarm()</a> function. Also, a time event can be re-armed to fire in a different number of clock ticks by calling the <a class="el" href="struct_q_time_evt.html#a3a5734e32caac22b89766a4b90a1679b" title="Rearm a time event.">QTimeEvt_rearm()</a> function.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd>The following example shows how to arm a one-shot time event from a state machine of an active object: <div class="fragment"><div class="line"><a class="code" href="qep_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> Philo_eating(Philo * <span class="keyword">const</span> me, <a class="code" href="struct_q_evt.html">QEvt</a> <span class="keyword">const</span> * <span class="keyword">const</span> e) {</div>
<div class="line">    <a class="code" href="qep_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a> status;</div>
<div class="line">    <span class="keywordflow">switch</span> (e-&gt;<a class="code" href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">sig</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="qep_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ac286909dd59290d1076b51d4cfdfaefe">Q_ENTRY_SIG</a>: {</div>
<div class="line">            <a class="code" href="struct_q_time_evt.html#a9bbcb00315fb8bb8641003b2b2d07ce4">QTimeEvt_armX</a>(&amp;me-&gt;timeEvt, EAT_TIME, 0U); <span class="comment">/* one shot */</span></div>
<div class="line">            status = <a class="code" href="qep_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="qep_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ab54538c21a62926a2f1d63d8fd45bf5c">Q_EXIT_SIG</a>: {</div>
<div class="line">            TableEvt *pe;</div>
<div class="line">            <a class="code" href="struct_q_time_evt.html#a9d4bc166d6d02d43fe5621cdd29c5013">QTimeEvt_disarm</a>(&amp;me-&gt;timeEvt);</div>
<div class="line">            pe = <a class="code" href="qf_8h.html#abd823f3a9e8b3206a3460a108d5fa3e3">Q_NEW</a>(TableEvt, DONE_SIG);</div>
<div class="line">            pe-&gt;philNum = me-&gt;num;</div>
<div class="line">            <a class="code" href="qf_8h.html#afd57334f2a1664a168b0702a106e0782">QF_PUBLISH</a>((<a class="code" href="struct_q_evt.html">QEvt</a> *)pe, me);</div>
<div class="line">            status = <a class="code" href="qep_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a>();</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">case</span> TIMEOUT_SIG: {</div>
<div class="line">            status = <a class="code" href="qep_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a>(&amp;Philosopher_thinking);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">default</span>: {</div>
<div class="line">            status = <a class="code" href="qep_8h.html#ad8abd2f7098c41ec464343d9d8f1eadc">Q_SUPER</a>(&amp;<a class="code" href="struct_q_hsm.html#ac8ae4728dfab5ce26a907fc624f6e104">QHsm_top</a>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>the host AO must be valid, time evnet must be disarmed, number of clock ticks cannot be zero, and the signal must be valid.</dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00297">297</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a9d4bc166d6d02d43fe5621cdd29c5013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d4bc166d6d02d43fe5621cdd29c5013">&#9670;&nbsp;</a></span>QTimeEvt_disarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QTimeEvt_disarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>Disarm the time event so it can be safely reused.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if the time event was truly disarmed, that is, it was running. The return of 'false' means that the time event was not truly disarmed, because it was not running. The 'false' return is only possible for one- shot time events that have been automatically disarmed upon expiration. In this case the 'false' return means that the time event has already been posted or published and should be expected in the active object's state machine.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>there is no harm in disarming an already disarmed time event </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00374">374</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a3a5734e32caac22b89766a4b90a1679b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a5734e32caac22b89766a4b90a1679b">&#9670;&nbsp;</a></span>QTimeEvt_rearm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QTimeEvt_rearm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> const&#160;</td>
          <td class="paramname"><em>nTicks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>Rearms a time event with a new number of clock ticks. This function can be used to adjust the current period of a periodic time event or to prevent a one-shot time event from expiring (e.g., a watchdog time event). Rearming a periodic timer leaves the interval unchanged and is a convenient method to adjust the phasing of a periodic time event.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nTicks</td><td>number of clock ticks (at the associated rate) to rearm the time event with.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if the time event was running as it was re-armed. The 'false' return means that the time event was not truly rearmed because it was not running. The 'false' return is only possible for one-shot time events that have been automatically disarmed upon expiration. In this case the 'false' return means that the time event has already been posted or published and should be expected in the active object's state machine. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>AO must be valid, tick rate must be in range, nTicks must not be zero, and the signal of this time event must be valid</dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00436">436</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a972d04658e1c8eec71da5976db433505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972d04658e1c8eec71da5976db433505">&#9670;&nbsp;</a></span>QTimeEvt_wasDisarmed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> QTimeEvt_wasDisarmed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> *const&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>Useful for checking whether a one-shot time event was disarmed in the <a class="el" href="struct_q_time_evt.html#a9d4bc166d6d02d43fe5621cdd29c5013" title="Disarm a time event.">QTimeEvt_disarm()</a> operation.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>'true' if the time event was truly disarmed in the last <a class="el" href="struct_q_time_evt.html#a9d4bc166d6d02d43fe5621cdd29c5013" title="Disarm a time event.">QTimeEvt_disarm()</a> operation. The 'false' return means that the time event was not truly disarmed, because it was not running at that time. The 'false' return is only possible for one-shot time events that have been automatically disarmed upon expiration. In this case the 'false' return means that the time event has already been posted or published and should be expected in the active object's event queue.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function has a <b>side effect</b> of setting the "was disarmed" status, which means that the second and subsequent times this function is called the function will return 'true'. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00519">519</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<a id="a5d8fc8c4421ae5131408ca74bd8138de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8fc8c4421ae5131408ca74bd8138de">&#9670;&nbsp;</a></span>QTimeEvt_currCtr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qf_8h.html#a1f3526b0c899ab9687db250ab58551e0">QTimeEvtCtr</a> QTimeEvt_currCtr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> const *const&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description</dt><dd>Useful for checking how many clock ticks (at the tick rate associated with the time event) remain until the time event expires.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>For an armed time event, the function returns the current value of the down-counter of the given time event. If the time event is not armed, the function returns 0.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function is thread-safe. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00541">541</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aae27f8be7b90468f9023fc4d2047dac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae27f8be7b90468f9023fc4d2047dac4">&#9670;&nbsp;</a></span>QF_timeEvtHead_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_q_time_evt.html">QTimeEvt</a> QF_timeEvtHead_[<a class="el" href="qxk_2qf__port_8h.html#a2b5eb0c96105f58726359f4fcfae9530">QF_MAX_TICK_RATE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>heads of linked lists of time events, one for every clock tick rate </p>

<p class="definition">Definition at line <a class="el" href="qf__time_8c_source.html#l00054">54</a> of file <a class="el" href="qf__time_8c_source.html">qf_time.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astruct_q_time_evt_html_a9bbcb00315fb8bb8641003b2b2d07ce4"><div class="ttname"><a href="struct_q_time_evt.html#a9bbcb00315fb8bb8641003b2b2d07ce4">QTimeEvt::QTimeEvt_armX</a></div><div class="ttdeci">void QTimeEvt_armX(QTimeEvt *const me, QTimeEvtCtr const nTicks, QTimeEvtCtr const interval)</div><div class="ttdoc">Arm a time event (one shot or periodic) for direct event posting.</div><div class="ttdef"><b>Definition:</b> <a href="qf__time_8c_source.html#l00297">qf_time.c:297</a></div></div>
<div class="ttc" id="astruct_q_time_evt_html_a9d4bc166d6d02d43fe5621cdd29c5013"><div class="ttname"><a href="struct_q_time_evt.html#a9d4bc166d6d02d43fe5621cdd29c5013">QTimeEvt::QTimeEvt_disarm</a></div><div class="ttdeci">bool QTimeEvt_disarm(QTimeEvt *const me)</div><div class="ttdoc">Disarm a time event.</div><div class="ttdef"><b>Definition:</b> <a href="qf__time_8c_source.html#l00374">qf_time.c:374</a></div></div>
<div class="ttc" id="astruct_q_evt_html_a20b1ceebb91aea39fcbc633aeae6cd3f"><div class="ttname"><a href="struct_q_evt.html#a20b1ceebb91aea39fcbc633aeae6cd3f">QEvt::sig</a></div><div class="ttdeci">QSignal sig</div><div class="ttdoc">signal of the event instance</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00152">qep.h:152</a></div></div>
<div class="ttc" id="aqep_8h_html_a54b2da5e70ef983cfa7ca74deac237a3"><div class="ttname"><a href="qep_8h.html#a54b2da5e70ef983cfa7ca74deac237a3">Q_HANDLED</a></div><div class="ttdeci">#define Q_HANDLED()</div><div class="ttdoc">Macro to call in a state-handler when it handles an event.</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00566">qep.h:566</a></div></div>
<div class="ttc" id="aqep_8h_html_adf764cbdea00d65edcd07bb9953ad2b7ac286909dd59290d1076b51d4cfdfaefe"><div class="ttname"><a href="qep_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ac286909dd59290d1076b51d4cfdfaefe">Q_ENTRY_SIG</a></div><div class="ttdeci">@ Q_ENTRY_SIG</div><div class="ttdoc">signal for coding entry actions</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00702">qep.h:702</a></div></div>
<div class="ttc" id="aqep_8h_html_ad141f4e9efcba4613f82a8b2c76663ad"><div class="ttname"><a href="qep_8h.html#ad141f4e9efcba4613f82a8b2c76663ad">QState</a></div><div class="ttdeci">uint_fast8_t QState</div><div class="ttdoc">typedef of the return type from a state/action-handler function.</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00204">qep.h:204</a></div></div>
<div class="ttc" id="astruct_q_evt_html"><div class="ttname"><a href="struct_q_evt.html">QEvt</a></div><div class="ttdoc">Event class.</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00151">qep.h:151</a></div></div>
<div class="ttc" id="astruct_q_hsm_html_ac8ae4728dfab5ce26a907fc624f6e104"><div class="ttname"><a href="struct_q_hsm.html#ac8ae4728dfab5ce26a907fc624f6e104">QHsm::QHsm_top</a></div><div class="ttdeci">QState QHsm_top(void const *const me, QEvt const *const e)</div><div class="ttdoc">the top-state.</div><div class="ttdef"><b>Definition:</b> <a href="qep__hsm_8c_source.html#l00248">qep_hsm.c:248</a></div></div>
<div class="ttc" id="aqep_8h_html_a8f06cd90ba5060780fc61a4810e3eb50"><div class="ttname"><a href="qep_8h.html#a8f06cd90ba5060780fc61a4810e3eb50">Q_TRAN</a></div><div class="ttdeci">#define Q_TRAN(target_)</div><div class="ttdoc">Macro to call in a state-handler when it executes a regular or and initial transition.</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00542">qep.h:542</a></div></div>
<div class="ttc" id="aqep_8h_html_adf764cbdea00d65edcd07bb9953ad2b7ab54538c21a62926a2f1d63d8fd45bf5c"><div class="ttname"><a href="qep_8h.html#adf764cbdea00d65edcd07bb9953ad2b7ab54538c21a62926a2f1d63d8fd45bf5c">Q_EXIT_SIG</a></div><div class="ttdeci">@ Q_EXIT_SIG</div><div class="ttdoc">signal for coding exit actions</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00703">qep.h:703</a></div></div>
<div class="ttc" id="aqf_8h_html_abd823f3a9e8b3206a3460a108d5fa3e3"><div class="ttname"><a href="qf_8h.html#abd823f3a9e8b3206a3460a108d5fa3e3">Q_NEW</a></div><div class="ttdeci">#define Q_NEW(evtT_, sig_)</div><div class="ttdoc">Allocate a dynamic event.</div><div class="ttdef"><b>Definition:</b> <a href="qf_8h_source.html#l00756">qf.h:756</a></div></div>
<div class="ttc" id="aqep_8h_html_ad8abd2f7098c41ec464343d9d8f1eadc"><div class="ttname"><a href="qep_8h.html#ad8abd2f7098c41ec464343d9d8f1eadc">Q_SUPER</a></div><div class="ttdeci">#define Q_SUPER(super_)</div><div class="ttdoc">Macro to call in a state-handler when it designates the superstate of a given state.</div><div class="ttdef"><b>Definition:</b> <a href="qep_8h_source.html#l00560">qep.h:560</a></div></div>
<div class="ttc" id="aqf_8h_html_afd57334f2a1664a168b0702a106e0782"><div class="ttname"><a href="qf_8h.html#afd57334f2a1664a168b0702a106e0782">QF_PUBLISH</a></div><div class="ttdeci">#define QF_PUBLISH(e_, sender_)</div><div class="ttdoc">Invoke the event publishing facility QF_publish_().</div><div class="ttdef"><b>Definition:</b> <a href="qf_8h_source.html#l00632">qf.h:632</a></div></div>
<!-- start footer part -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
      <ul>
        <li class="navelem"><a class="el" href="dir_28a04cc6444cdd1b436423abf3214ac3.html">src</a></li><li class="navelem"><a class="el" href="dir_023a0acd75d733ac8b46de46495bcccd.html">qf</a></li><li class="navelem"><a class="el" href="qf__time_8c.html">qf_time.c</a></li>
        <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C 6.9.1</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C 6.9.1</b>
</small></address>
        </li>
      </ul>
    </div>
    <script src="custom.js"></script>
  </body>
</html>
